<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Senstivity-Analysis • MEMC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Senstivity-Analysis">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MEMC</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.999999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/Manual.html">Mannual</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/ModelComparison.html">Run all model configurations</a></li>
    <li><a class="dropdown-item" href="../articles/sens.html">Sensitivity analysis </a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JGCRI/hector"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Senstivity-Analysis</h1>
            
      

      <div class="d-none name"><code>sens.Rmd</code></div>
    </div>

    
    
<p>The objective of this example is demonstrate how to easily conduct a
sensitivity analysis and visualize results using
<code>memc_sensrange</code>, <code>memc_sensfunc</code>, and
<code>memc_format_sensout</code>. This is a demonstration of package
capabilities more than a rigorous analysis. The first section will
demonstrate how to use the MEMC functions related to sensitivity
analyses, and the second will show how alternative model configurations
can affect sensitivity results.</p>
<div class="section level3">
<h3 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://microbial-explicit-model.github.io/MEMC">MEMC</a></span><span class="op">)</span> <span class="co"># Load the installed MEMC package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># Used to plot results</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-the-paramter-ranges">Define the paramter ranges<a class="anchor" aria-label="anchor" href="#define-the-paramter-ranges"></a>
</h3>
<p>Set up a data frame defining the parameter ranges to sample from. Any
model parameters or initial pool sizes can be used; in this example we
explore the effects that maximum specific decomposition constants for
POM, DOM, and MOM have on model behavior. For simplicity, here we sample
a broad range (50% of the parameter value), but a real analysis would
use more informed parameter ranges from the literature,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V_d"</span> <span class="op">=</span> <span class="fl">3.0e+00</span>, <span class="st">"V_p"</span> <span class="op">=</span> <span class="fl">1.4e+01</span>, <span class="st">"V_m"</span> <span class="op">=</span> <span class="fl">2.5e-01</span><span class="op">)</span></span>
<span><span class="va">prange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                     min <span class="op">=</span> <span class="va">pars</span> <span class="op">*</span> <span class="fl">0.50</span>, </span>
<span>                     max <span class="op">=</span> <span class="va">pars</span> <span class="op">*</span> <span class="fl">1.50</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="memc_sensrange">
<code>memc_sensrange</code><a class="anchor" aria-label="anchor" href="#memc_sensrange"></a>
</h3>
<p>The <code>memc_sensrange</code> function is <code>MEMC</code>
specific wrapper of <code><a href="https://rdrr.io/pkg/FME/man/sensRange.html" class="external-link">FME::sensRange</a></code>.
<code>memc_sensrange</code> allows users to easily run a
<code>MEMC</code> model configuration with parameter combinations drawn
from a predefined distribution, ultimately generating an uncertainty
envelope around model results.</p>
<p>The inputs to MEMC’s <code>memc_sensrange</code> function are:</p>
<ul>
<li>
<code>config</code>: a MEMC model configuration object, either one
of the pre-built configurations listed in <code>memc_all_configs</code>
or created using <code>memc_configure</code>
</li>
<li>
<code>t</code>: vector of the time steps to run the model at
*<code>pars</code>: vector of the parameters that will be varied</li>
<li>
<code>parRange</code>: data frame of the min/max parameter
values</li>
<li>
<code>dist</code>: str for the distribution according to which the
parameters will be sampled from, with options “unif” (uniformly random
samples), “norm”, (normally distributed random samples), “latin” (latin
hypercube distribution), and “grid” (parameters arranged on a grid)</li>
<li>
<code>n</code>: integer number of sampled parameter combinations to
run the model with</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MENDsens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">MEND_config</span>,</span>
<span>                               t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span><span class="op">)</span>, </span>
<span>                               x <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                               parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                               dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                               n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>Take a quick look at the results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">MENDsens_out</span><span class="op">)</span></span>
<span><span class="co">#&gt;   name time     Mean         Sd      Min      Max      q05      q25      q50</span></span>
<span><span class="co">#&gt; 1 MEND    0 10.00000 0.00000000 10.00000 10.00000 10.00000 10.00000 10.00000</span></span>
<span><span class="co">#&gt; 2 MEND    1 10.86992 0.19439305 10.53020 11.18292 10.57510 10.72961 10.84806</span></span>
<span><span class="co">#&gt; 3 MEND    2 11.12541 0.11780458 10.85746 11.29208 10.91514 11.06901 11.13699</span></span>
<span><span class="co">#&gt; 4 MEND    3 11.17755 0.05953595 11.03575 11.26213 11.08888 11.13324 11.18862</span></span>
<span><span class="co">#&gt; 5 MEND    4 11.15520 0.08413019 10.96736 11.28846 10.99452 11.11386 11.16870</span></span>
<span><span class="co">#&gt; 6 MEND    5 11.10183 0.12984174 10.82407 11.27720 10.86392 11.01607 11.13782</span></span>
<span><span class="co">#&gt;        q75      q95 variable</span></span>
<span><span class="co">#&gt; 1 10.00000 10.00000      POM</span></span>
<span><span class="co">#&gt; 2 11.05082 11.15449      POM</span></span>
<span><span class="co">#&gt; 3 11.21465 11.28131      POM</span></span>
<span><span class="co">#&gt; 4 11.23029 11.25679      POM</span></span>
<span><span class="co">#&gt; 5 11.22252 11.26839      POM</span></span>
<span><span class="co">#&gt; 6 11.21506 11.25610      POM</span></span></code></pre></div>
<p>Visualize results using R’s base <code>plot</code> function. This is
a quick way to look at results, but for more user control over the
figures we recommend using <a href="https://ggplot2-book.org" class="external-link">ggplot2</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MENDsens_out</span><span class="op">)</span></span></code></pre></div>
<p><img src="sens_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="memc_sensfun">
<code>memc_sensfun</code><a class="anchor" aria-label="anchor" href="#memc_sensfun"></a>
</h3>
<p>Given a MEMC model configuration, estimate the local effect of
certain parameters on selected sensitivity variables by calculating a
matrix of so-called sensitivity functions based on
<code><a href="https://rdrr.io/pkg/FME/man/sensFun.html" class="external-link">FME::sensFun</a></code>.</p>
<p>The inputs to MEMC’s <code>memc_sensfun</code> function are: *
<code>config</code>: a MEMC model configuration object, either one of
the pre-built configurations listed in <code>memc_all_configs</code> or
created using <code>memc_configure</code> * <code>t</code>: numeric
vector of the time steps to run the model at * <code>pars</code>: vector
specifying the model parameters to test</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensfunc.html">memc_sensfunc</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">MEND_config</span>,</span>
<span>                          t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span><span class="op">)</span>,</span>
<span>                          x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V_d"</span> <span class="op">=</span> <span class="fl">3.0e+00</span>,<span class="st">"V_p"</span> <span class="op">=</span> <span class="fl">1.4e+01</span>,<span class="st">"V_m"</span> <span class="op">=</span> <span class="fl">2.5e-01</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Take a look at the results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sens_out</span><span class="op">)</span></span>
<span><span class="co">#&gt;      name  time variable parameter        value</span></span>
<span><span class="co">#&gt;    &lt;char&gt; &lt;num&gt;   &lt;char&gt;    &lt;fctr&gt;        &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:   MEND     0      POM       V_d  0.000000000</span></span>
<span><span class="co">#&gt; 2:   MEND     1      POM       V_d  0.048743867</span></span>
<span><span class="co">#&gt; 3:   MEND     2      POM       V_d  0.033570845</span></span>
<span><span class="co">#&gt; 4:   MEND     3      POM       V_d  0.015965606</span></span>
<span><span class="co">#&gt; 5:   MEND     4      POM       V_d  0.004513539</span></span>
<span><span class="co">#&gt; 6:   MEND     5      POM       V_d -0.001963303</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="memc_format_sensout">
<code>memc_format_sensout</code><a class="anchor" aria-label="anchor" href="#memc_format_sensout"></a>
</h3>
<p>To visualize the results from <code>memc_sensfun</code> we use the
helper function <code>memc_format_sensout</code>, which formats the
returned object into a data frame that can be used by
<code>ggplot</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sens_out</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"variable"</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sens_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="global-parameter-sensivity-model-comparison">Global Parameter Sensivity Model Comparison<a class="anchor" aria-label="anchor" href="#global-parameter-sensivity-model-comparison"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V_d"</span> <span class="op">=</span> <span class="fl">3.0e+00</span>,</span>
<span>                              <span class="st">"V_p"</span> <span class="op">=</span> <span class="fl">1.4e+01</span>,</span>
<span>                              <span class="st">"V_m"</span> <span class="op">=</span> <span class="fl">2.5e-01</span><span class="op">)</span>, </span>
<span>                     min <span class="op">=</span> <span class="va">pars</span> <span class="op">*</span> <span class="fl">0.50</span>, </span>
<span>                     max <span class="op">=</span> <span class="va">pars</span> <span class="op">*</span> <span class="fl">1.50</span><span class="op">)</span></span></code></pre></div>
<p>Use the same parameter ranges with each of the different MEMC model
configurations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">MENDsens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">MEND_config</span>,</span>
<span>                               t <span class="op">=</span> <span class="va">time</span>, </span>
<span>                               x <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                               parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                               dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                               n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">COMISSIONsens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">COMISSION_config</span>,</span>
<span>                                    t <span class="op">=</span> <span class="va">time</span>, </span>
<span>                                    x <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                                    parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                                    dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                                    n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">CORPSEsens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">CORPSE_config</span>,</span>
<span>                                 t <span class="op">=</span> <span class="va">time</span>, </span>
<span>                                 x <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                                 parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                                 dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                                 n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">MEMSens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">MEMS_config</span>,</span>
<span>                              t <span class="op">=</span> <span class="va">time</span>, </span>
<span>                              x <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                              parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                              dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                              n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">BAMSens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">BAMS_config</span>,</span>
<span>                              t <span class="op">=</span> <span class="va">time</span>, </span>
<span>                              x <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                              parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                              dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                              n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">MIMCSens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">MIMCS_config</span>,</span>
<span>                               t <span class="op">=</span> <span class="va">time</span>, </span>
<span>                               x <span class="op">=</span> <span class="va">pars</span>, </span>
<span>                               parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                               dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                               n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>Prepare all of the data into a single data frame for plotting.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">MENDsens_out</span>, <span class="va">COMISSIONsens_out</span>, <span class="va">CORPSEsens_out</span>,</span>
<span>             <span class="va">MEMSens_out</span>, <span class="va">BAMSens_out</span>, <span class="va">MIMCSens_out</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, ymin <span class="op">=</span> <span class="va">q25</span>, ymax <span class="op">=</span> <span class="va">q75</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">Mean</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"variable"</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"mg C/g soil"</span>, </span>
<span>       x <span class="op">=</span> <span class="st">"Time (days)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Global Sensitivity to Vd, Vp &amp; Vm"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"q25/q75"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="../reference/memc_colorPalette.html">memc_colorPalette</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="../reference/memc_colorPalette.html">memc_colorPalette</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sens_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="comparison-of-local-parameter-sensivity">Comparison of Local Parameter Sensivity<a class="anchor" aria-label="anchor" href="#comparison-of-local-parameter-sensivity"></a>
</h2>
<p>Use the <code>memc_sensfun</code> to compare the sensitivity of the
DOM pool to <code>V_d</code> and <code>K_d</code>, two parameters that
affect the MB uptake of DOM for MEND and CORPSE.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span></span>
<span><span class="va">MENDsens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensfunc.html">memc_sensfunc</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">MEND_config</span>,</span>
<span>                              t <span class="op">=</span> <span class="va">time</span>,</span>
<span>                              x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V_d"</span> <span class="op">=</span> <span class="fl">3.0e+00</span>,<span class="st">"K_d"</span> <span class="op">=</span> <span class="fl">0.250</span><span class="op">)</span>, </span>
<span>                              sensvar <span class="op">=</span> <span class="st">"DOM"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CORPSEsens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensfunc.html">memc_sensfunc</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">CORPSE_config</span>,</span>
<span>                                t <span class="op">=</span> <span class="va">time</span>,</span>
<span>                                x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V_d"</span> <span class="op">=</span> <span class="fl">3.0e+00</span>,<span class="st">"K_d"</span> <span class="op">=</span> <span class="fl">0.250</span><span class="op">)</span>, </span>
<span>                                sensvar <span class="op">=</span> <span class="st">"DOM"</span><span class="op">)</span></span></code></pre></div>
<p>Format output and visualize the results.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">CORPSEsens_out</span>, <span class="va">MENDsens_out</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">out</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"parameter"</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Local Senstivity to DOM"</span>, </span>
<span>       x <span class="op">=</span> <span class="st">"Time (days)"</span>, y <span class="op">=</span> <span class="st">""</span> <span class="op">)</span> </span></code></pre></div>
<p><img src="sens_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="model-sensitivity-to-inital-pool-sizes">Model Sensitivity to Inital Pool Sizes<a class="anchor" aria-label="anchor" href="#model-sensitivity-to-inital-pool-sizes"></a>
</h2>
<p>The MEMC models are also sensitive to the initial pool size! Here we
will demonstrate how model results are sensitive to uncertainty within a
single pool! This being said the initial carbon pool sizes matter and
users will need to make sure that they are using the appropriate values
for their applications.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pools</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DOM"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">prange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pools <span class="op">=</span> <span class="va">pools</span>, </span>
<span>                     min <span class="op">=</span> <span class="va">pools</span> <span class="op">*</span> <span class="fl">0.50</span>, </span>
<span>                     max <span class="op">=</span> <span class="va">pools</span> <span class="op">*</span> <span class="fl">1.50</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inital_pool_uncertainty</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/memc_sensrange.html">memc_sensrange</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">MEND_config</span>,</span>
<span>                                          t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span><span class="op">)</span>, </span>
<span>                                          x <span class="op">=</span> <span class="va">pools</span>, </span>
<span>                                          parRange <span class="op">=</span> <span class="va">prange</span>, </span>
<span>                                          dist <span class="op">=</span> <span class="st">"latin"</span>,</span>
<span>                                          n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inital_pool_uncertainty</span><span class="op">)</span></span></code></pre></div>
<p><img src="sens_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kalyn Dorheim, Jianqiu Zheng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
